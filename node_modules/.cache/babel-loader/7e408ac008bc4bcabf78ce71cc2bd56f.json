{"ast":null,"code":"var hasOwnProperty = Object.prototype.hasOwnProperty;\n\nvar noop = function () {};\n\nfunction ensureFunction(value) {\n  return typeof value === 'function' ? value : noop;\n}\n\nfunction invokeForType(fn, type) {\n  return function (node, item, list) {\n    if (node.type === type) {\n      fn.call(this, node, item, list);\n    }\n  };\n}\n\nfunction getWalkersFromStructure(name, nodeType) {\n  var structure = nodeType.structure;\n  var walkers = [];\n\n  for (var key in structure) {\n    if (hasOwnProperty.call(structure, key) === false) {\n      continue;\n    }\n\n    var fieldTypes = structure[key];\n    var walker = {\n      name: key,\n      type: false,\n      nullable: false\n    };\n\n    if (!Array.isArray(structure[key])) {\n      fieldTypes = [structure[key]];\n    }\n\n    for (var i = 0; i < fieldTypes.length; i++) {\n      var fieldType = fieldTypes[i];\n\n      if (fieldType === null) {\n        walker.nullable = true;\n      } else if (typeof fieldType === 'string') {\n        walker.type = 'node';\n      } else if (Array.isArray(fieldType)) {\n        walker.type = 'list';\n      }\n    }\n\n    if (walker.type) {\n      walkers.push(walker);\n    }\n  }\n\n  if (walkers.length) {\n    return {\n      context: nodeType.walkContext,\n      fields: walkers\n    };\n  }\n\n  return null;\n}\n\nfunction getTypesFromConfig(config) {\n  var types = {};\n\n  for (var name in config.node) {\n    if (hasOwnProperty.call(config.node, name)) {\n      var nodeType = config.node[name];\n\n      if (!nodeType.structure) {\n        throw new Error('Missed `structure` field in `' + name + '` node type definition');\n      }\n\n      types[name] = getWalkersFromStructure(name, nodeType);\n    }\n  }\n\n  return types;\n}\n\nfunction createTypeIterator(config, reverse) {\n  var fields = config.fields.slice();\n  var contextName = config.context;\n  var useContext = typeof contextName === 'string';\n\n  if (reverse) {\n    fields.reverse();\n  }\n\n  return function (node, context, walk, walkReducer) {\n    var prevContextValue;\n\n    if (useContext) {\n      prevContextValue = context[contextName];\n      context[contextName] = node;\n    }\n\n    for (var i = 0; i < fields.length; i++) {\n      var field = fields[i];\n      var ref = node[field.name];\n\n      if (!field.nullable || ref) {\n        if (field.type === 'list') {\n          var breakWalk = reverse ? ref.reduceRight(walkReducer, false) : ref.reduce(walkReducer, false);\n\n          if (breakWalk) {\n            return true;\n          }\n        } else if (walk(ref)) {\n          return true;\n        }\n      }\n    }\n\n    if (useContext) {\n      context[contextName] = prevContextValue;\n    }\n  };\n}\n\nfunction createFastTraveralMap(iterators) {\n  return {\n    Atrule: {\n      StyleSheet: iterators.StyleSheet,\n      Atrule: iterators.Atrule,\n      Rule: iterators.Rule,\n      Block: iterators.Block\n    },\n    Rule: {\n      StyleSheet: iterators.StyleSheet,\n      Atrule: iterators.Atrule,\n      Rule: iterators.Rule,\n      Block: iterators.Block\n    },\n    Declaration: {\n      StyleSheet: iterators.StyleSheet,\n      Atrule: iterators.Atrule,\n      Rule: iterators.Rule,\n      Block: iterators.Block,\n      DeclarationList: iterators.DeclarationList\n    }\n  };\n}\n\nmodule.exports = function createWalker(config) {\n  var types = getTypesFromConfig(config);\n  var iteratorsNatural = {};\n  var iteratorsReverse = {};\n  var breakWalk = Symbol('break-walk');\n  var skipNode = Symbol('skip-node');\n\n  for (var name in types) {\n    if (hasOwnProperty.call(types, name) && types[name] !== null) {\n      iteratorsNatural[name] = createTypeIterator(types[name], false);\n      iteratorsReverse[name] = createTypeIterator(types[name], true);\n    }\n  }\n\n  var fastTraversalIteratorsNatural = createFastTraveralMap(iteratorsNatural);\n  var fastTraversalIteratorsReverse = createFastTraveralMap(iteratorsReverse);\n\n  var walk = function (root, options) {\n    function walkNode(node, item, list) {\n      var enterRet = enter.call(context, node, item, list);\n\n      if (enterRet === breakWalk) {\n        debugger;\n        return true;\n      }\n\n      if (enterRet === skipNode) {\n        return false;\n      }\n\n      if (iterators.hasOwnProperty(node.type)) {\n        if (iterators[node.type](node, context, walkNode, walkReducer)) {\n          return true;\n        }\n      }\n\n      if (leave.call(context, node, item, list) === breakWalk) {\n        return true;\n      }\n\n      return false;\n    }\n\n    var walkReducer = (ret, data, item, list) => ret || walkNode(data, item, list);\n\n    var enter = noop;\n    var leave = noop;\n    var iterators = iteratorsNatural;\n    var context = {\n      break: breakWalk,\n      skip: skipNode,\n      root: root,\n      stylesheet: null,\n      atrule: null,\n      atrulePrelude: null,\n      rule: null,\n      selector: null,\n      block: null,\n      declaration: null,\n      function: null\n    };\n\n    if (typeof options === 'function') {\n      enter = options;\n    } else if (options) {\n      enter = ensureFunction(options.enter);\n      leave = ensureFunction(options.leave);\n\n      if (options.reverse) {\n        iterators = iteratorsReverse;\n      }\n\n      if (options.visit) {\n        if (fastTraversalIteratorsNatural.hasOwnProperty(options.visit)) {\n          iterators = options.reverse ? fastTraversalIteratorsReverse[options.visit] : fastTraversalIteratorsNatural[options.visit];\n        } else if (!types.hasOwnProperty(options.visit)) {\n          throw new Error('Bad value `' + options.visit + '` for `visit` option (should be: ' + Object.keys(types).join(', ') + ')');\n        }\n\n        enter = invokeForType(enter, options.visit);\n        leave = invokeForType(leave, options.visit);\n      }\n    }\n\n    if (enter === noop && leave === noop) {\n      throw new Error('Neither `enter` nor `leave` walker handler is set or both aren\\'t a function');\n    }\n\n    walkNode(root);\n  };\n\n  walk.break = breakWalk;\n  walk.skip = skipNode;\n\n  walk.find = function (ast, fn) {\n    var found = null;\n    walk(ast, function (node, item, list) {\n      if (fn.call(this, node, item, list)) {\n        found = node;\n        return breakWalk;\n      }\n    });\n    return found;\n  };\n\n  walk.findLast = function (ast, fn) {\n    var found = null;\n    walk(ast, {\n      reverse: true,\n      enter: function (node, item, list) {\n        if (fn.call(this, node, item, list)) {\n          found = node;\n          return breakWalk;\n        }\n      }\n    });\n    return found;\n  };\n\n  walk.findAll = function (ast, fn) {\n    var found = [];\n    walk(ast, function (node, item, list) {\n      if (fn.call(this, node, item, list)) {\n        found.push(node);\n      }\n    });\n    return found;\n  };\n\n  return walk;\n};","map":{"version":3,"sources":["/Users/macbook/Documents/GitHub/React 3/billing-app/node_modules/react-pdf-html/node_modules/css-tree/lib/walker/create.js"],"names":["hasOwnProperty","Object","prototype","noop","ensureFunction","value","invokeForType","fn","type","node","item","list","call","getWalkersFromStructure","name","nodeType","structure","walkers","key","fieldTypes","walker","nullable","Array","isArray","i","length","fieldType","push","context","walkContext","fields","getTypesFromConfig","config","types","Error","createTypeIterator","reverse","slice","contextName","useContext","walk","walkReducer","prevContextValue","field","ref","breakWalk","reduceRight","reduce","createFastTraveralMap","iterators","Atrule","StyleSheet","Rule","Block","Declaration","DeclarationList","module","exports","createWalker","iteratorsNatural","iteratorsReverse","Symbol","skipNode","fastTraversalIteratorsNatural","fastTraversalIteratorsReverse","root","options","walkNode","enterRet","enter","leave","ret","data","break","skip","stylesheet","atrule","atrulePrelude","rule","selector","block","declaration","function","visit","keys","join","find","ast","found","findLast","findAll"],"mappings":"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","sourcesContent":["var hasOwnProperty = Object.prototype.hasOwnProperty;\nvar noop = function() {};\n\nfunction ensureFunction(value) {\n    return typeof value === 'function' ? value : noop;\n}\n\nfunction invokeForType(fn, type) {\n    return function(node, item, list) {\n        if (node.type === type) {\n            fn.call(this, node, item, list);\n        }\n    };\n}\n\nfunction getWalkersFromStructure(name, nodeType) {\n    var structure = nodeType.structure;\n    var walkers = [];\n\n    for (var key in structure) {\n        if (hasOwnProperty.call(structure, key) === false) {\n            continue;\n        }\n\n        var fieldTypes = structure[key];\n        var walker = {\n            name: key,\n            type: false,\n            nullable: false\n        };\n\n        if (!Array.isArray(structure[key])) {\n            fieldTypes = [structure[key]];\n        }\n\n        for (var i = 0; i < fieldTypes.length; i++) {\n            var fieldType = fieldTypes[i];\n            if (fieldType === null) {\n                walker.nullable = true;\n            } else if (typeof fieldType === 'string') {\n                walker.type = 'node';\n            } else if (Array.isArray(fieldType)) {\n                walker.type = 'list';\n            }\n        }\n\n        if (walker.type) {\n            walkers.push(walker);\n        }\n    }\n\n    if (walkers.length) {\n        return {\n            context: nodeType.walkContext,\n            fields: walkers\n        };\n    }\n\n    return null;\n}\n\nfunction getTypesFromConfig(config) {\n    var types = {};\n\n    for (var name in config.node) {\n        if (hasOwnProperty.call(config.node, name)) {\n            var nodeType = config.node[name];\n\n            if (!nodeType.structure) {\n                throw new Error('Missed `structure` field in `' + name + '` node type definition');\n            }\n\n            types[name] = getWalkersFromStructure(name, nodeType);\n        }\n    }\n\n    return types;\n}\n\nfunction createTypeIterator(config, reverse) {\n    var fields = config.fields.slice();\n    var contextName = config.context;\n    var useContext = typeof contextName === 'string';\n\n    if (reverse) {\n        fields.reverse();\n    }\n\n    return function(node, context, walk, walkReducer) {\n        var prevContextValue;\n\n        if (useContext) {\n            prevContextValue = context[contextName];\n            context[contextName] = node;\n        }\n\n        for (var i = 0; i < fields.length; i++) {\n            var field = fields[i];\n            var ref = node[field.name];\n\n            if (!field.nullable || ref) {\n                if (field.type === 'list') {\n                    var breakWalk = reverse\n                        ? ref.reduceRight(walkReducer, false)\n                        : ref.reduce(walkReducer, false);\n\n                    if (breakWalk) {\n                        return true;\n                    }\n                } else if (walk(ref)) {\n                    return true;\n                }\n            }\n        }\n\n        if (useContext) {\n            context[contextName] = prevContextValue;\n        }\n    };\n}\n\nfunction createFastTraveralMap(iterators) {\n    return {\n        Atrule: {\n            StyleSheet: iterators.StyleSheet,\n            Atrule: iterators.Atrule,\n            Rule: iterators.Rule,\n            Block: iterators.Block\n        },\n        Rule: {\n            StyleSheet: iterators.StyleSheet,\n            Atrule: iterators.Atrule,\n            Rule: iterators.Rule,\n            Block: iterators.Block\n        },\n        Declaration: {\n            StyleSheet: iterators.StyleSheet,\n            Atrule: iterators.Atrule,\n            Rule: iterators.Rule,\n            Block: iterators.Block,\n            DeclarationList: iterators.DeclarationList\n        }\n    };\n}\n\nmodule.exports = function createWalker(config) {\n    var types = getTypesFromConfig(config);\n    var iteratorsNatural = {};\n    var iteratorsReverse = {};\n    var breakWalk = Symbol('break-walk');\n    var skipNode = Symbol('skip-node');\n\n    for (var name in types) {\n        if (hasOwnProperty.call(types, name) && types[name] !== null) {\n            iteratorsNatural[name] = createTypeIterator(types[name], false);\n            iteratorsReverse[name] = createTypeIterator(types[name], true);\n        }\n    }\n\n    var fastTraversalIteratorsNatural = createFastTraveralMap(iteratorsNatural);\n    var fastTraversalIteratorsReverse = createFastTraveralMap(iteratorsReverse);\n\n    var walk = function(root, options) {\n        function walkNode(node, item, list) {\n            var enterRet = enter.call(context, node, item, list);\n\n            if (enterRet === breakWalk) {\n                debugger;\n                return true;\n            }\n\n            if (enterRet === skipNode) {\n                return false;\n            }\n\n            if (iterators.hasOwnProperty(node.type)) {\n                if (iterators[node.type](node, context, walkNode, walkReducer)) {\n                    return true;\n                }\n            }\n\n            if (leave.call(context, node, item, list) === breakWalk) {\n                return true;\n            }\n\n            return false;\n        }\n\n        var walkReducer = (ret, data, item, list) => ret || walkNode(data, item, list);\n        var enter = noop;\n        var leave = noop;\n        var iterators = iteratorsNatural;\n        var context = {\n            break: breakWalk,\n            skip: skipNode,\n\n            root: root,\n            stylesheet: null,\n            atrule: null,\n            atrulePrelude: null,\n            rule: null,\n            selector: null,\n            block: null,\n            declaration: null,\n            function: null\n        };\n\n        if (typeof options === 'function') {\n            enter = options;\n        } else if (options) {\n            enter = ensureFunction(options.enter);\n            leave = ensureFunction(options.leave);\n\n            if (options.reverse) {\n                iterators = iteratorsReverse;\n            }\n\n            if (options.visit) {\n                if (fastTraversalIteratorsNatural.hasOwnProperty(options.visit)) {\n                    iterators = options.reverse\n                        ? fastTraversalIteratorsReverse[options.visit]\n                        : fastTraversalIteratorsNatural[options.visit];\n                } else if (!types.hasOwnProperty(options.visit)) {\n                    throw new Error('Bad value `' + options.visit + '` for `visit` option (should be: ' + Object.keys(types).join(', ') + ')');\n                }\n\n                enter = invokeForType(enter, options.visit);\n                leave = invokeForType(leave, options.visit);\n            }\n        }\n\n        if (enter === noop && leave === noop) {\n            throw new Error('Neither `enter` nor `leave` walker handler is set or both aren\\'t a function');\n        }\n\n        walkNode(root);\n    };\n\n    walk.break = breakWalk;\n    walk.skip = skipNode;\n\n    walk.find = function(ast, fn) {\n        var found = null;\n\n        walk(ast, function(node, item, list) {\n            if (fn.call(this, node, item, list)) {\n                found = node;\n                return breakWalk;\n            }\n        });\n\n        return found;\n    };\n\n    walk.findLast = function(ast, fn) {\n        var found = null;\n\n        walk(ast, {\n            reverse: true,\n            enter: function(node, item, list) {\n                if (fn.call(this, node, item, list)) {\n                    found = node;\n                    return breakWalk;\n                }\n            }\n        });\n\n        return found;\n    };\n\n    walk.findAll = function(ast, fn) {\n        var found = [];\n\n        walk(ast, function(node, item, list) {\n            if (fn.call(this, node, item, list)) {\n                found.push(node);\n            }\n        });\n\n        return found;\n    };\n\n    return walk;\n};\n"]},"metadata":{},"sourceType":"script"}